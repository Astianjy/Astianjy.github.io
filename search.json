[{"title":"Administrator Protection: Secure Your Admins!","url":"/2025/12/22/Administrator%20Protection%EF%BC%9ASecure%20Your%20Admins/","content":"How the New UAC Works vs. Legacy UAC1. Legacy UAC: Split Token ModelIn the traditional UAC model, when a user who belongs to the local Administrators group logs in, Windows creates two access tokens for that user:\n\nA standard user token\nAn administrator token (filtered but already present)\n\nBy default, all processes run under the standard token.\nWhen an administrative action is requested (e.g., “Run as administrator”), UAC prompts the user. If consent is granted, the same user account switches to its existing admin token and launches the elevated process.\nKey characteristics of legacy UAC:\n\nThe admin token already exists for the entire session\nElevation means activating an existing token, not creating a new identity\nMalware that gains sufficient access may:\nAbuse UAC auto-elevation\nBypass or hijack the consent mechanism\n\n\nAdmin privileges are logically separated, but still tied to the user account\n\n\n2. New UAC (Administrator Protection): Isolated Admin Account ModelWith Administrator Protection enabled (Windows 11 25H2+), Windows fundamentally changes the elevation mechanism.\nInstead of elevating the current user, Windows uses a System-Managed, hidden Administrator Account that is:\n\nSeparate from the logged-in user\nDisabled and inactive by default\nActivated only during an elevation request\n\nWhen an administrative action is required:\n\nThe user initiates an action requiring elevation\nWindows displays a Windows Security prompt (not the classic UAC dialog)\nUpon approval:\nWindows temporarily activates the system-managed admin account\nCreates a new elevated process under this separate account\n\n\nThe elevated process runs in an isolated admin context, with:\nA separate admin token\nA separate admin profile\nA separate registry hive (admin-specific data hive)\n\n\nOnce the task completes, the admin session is terminated and privileges are revoked\n\nKey characteristics of the new model:\n\nNo persistent admin token exists in the user session\nAdmin privileges are not tied to the user account\nElevation uses a different security principal, not the logged-in user\nPrivileges are granted just-in-time and just-for-task\nSignificantly reduces attack surface for privilege escalation\n\n\n3. Security Impact: Why This Is a Major Change\n\n\nAspect\nLegacy UAC\nAdministrator Protection\n\n\n\nAdmin token lifetime\nEntire user session\nOnly during elevation\n\n\nAdmin identity\nSame user account\nSeparate system-managed account\n\n\nPrivilege exposure\nContinuous (filtered)\nEphemeral\n\n\nToken theft risk\nHigher\nGreatly reduced\n\n\nUAC bypass impact\nOften effective\nLargely ineffective\n\n\nFrom a security perspective, the new UAC aligns with:\n\nZero Trust principles\nLeast privilege enforcement\nPrivilege isolation and session compartmentalization\n\nEven if an attacker compromises the user session, they cannot reuse or hijack admin privileges, because those privileges exist only in a short-lived, isolated execution context.\n\n4. One-Sentence Summary\nLegacy UAC elevates the user; Administrator Protection elevates a temporary, isolated system-managed admin identity.\n\n","categories":["内网渗透"],"tags":["BypassUAC"]}]